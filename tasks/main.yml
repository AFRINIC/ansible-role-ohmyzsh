---
- name: Install zsh (Debian-ish).
  apt: name: zsh state=present
  when: ansible_os_family == 'Debian' or ansible_distribution == 'Ubunutu'

- name: Install zsh (RHEL-ish).
  yum: name: zsh state=present
  when: ansible_distribution == "CentOS" or ansible_distribution == "Red Hat Enterprise Linux" or ansible_distribution == "Fedora"

- name: Clone oh-my-zsh.
  sudo: no
  git:
    repo: https://github.com/robbyrussell/oh-my-zsh.git
    dest: $HOME/.oh-my-zsh

- name: Copy .zshrc
  sudo: no
  template:
    src: zshrc.j2
    dest: ~/.zshrc
  when: ohmyzsh_copy_zshrc

- name: Change shell.
  user:
    name: "{{ item }}"
    shell: /bin/zsh
  with_items: ohmyzsh_users
  when: ohmyzsh_change_shell
